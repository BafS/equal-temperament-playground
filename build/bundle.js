var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function i(t,e,n){t.insertBefore(e,n||null)}function s(t){t.parentNode.removeChild(t)}function a(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function h(t){return document.createTextNode(t)}function d(){return h(" ")}function p(){return h("")}function m(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function w(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function $(t,e){t.value=null==e?"":e}function v(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}let x,b;function M(){if(void 0===x){x=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){x=!0}}return x}function q(t){b=t}function k(){if(!b)throw new Error("Function called outside component initialization");return b}const E=[],_=[],F=[],S=[],R=Promise.resolve();let z=!1;function C(t){F.push(t)}const A=new Set;let P=0;function I(){const t=b;do{for(;P<E.length;){const t=E[P];P++,q(t),T(t.$$)}for(q(null),E.length=0,P=0;_.length;)_.pop()();for(let t=0;t<F.length;t+=1){const e=F[t];A.has(e)||(A.add(e),e())}F.length=0}while(E.length);for(;S.length;)S.pop()();z=!1,A.clear(),q(t)}function T(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const O=new Set;function B(t,e){t&&t.i&&(O.delete(t),t.i(e))}function H(t,e,n,r){if(t&&t.o){if(O.has(t))return;O.add(t),undefined.c.push((()=>{O.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function j(t){t&&t.c()}function W(t,n,c,l){const{fragment:i,on_mount:s,on_destroy:a,after_update:u}=t.$$;i&&i.m(n,c),l||C((()=>{const n=s.map(e).filter(o);a?a.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(C)}function N(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(E.push(t),z||(z=!0,R.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(e,o,c,l,i,a,u,f=[-1]){const h=b;q(e);const d=e.$$={fragment:null,ctx:null,props:a,update:t,not_equal:i,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(h?h.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||h.$$.root};u&&u(d.root);let p=!1;if(d.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return d.ctx&&i(d.ctx[t],d.ctx[t]=o)&&(!d.skip_bound&&d.bound[t]&&d.bound[t](o),p&&D(e,t)),n})):[],d.update(),p=!0,r(d.before_update),d.fragment=!!l&&l(d.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);d.fragment&&d.fragment.l(t),t.forEach(s)}else d.fragment&&d.fragment.c();o.intro&&B(e.$$.fragment),W(e,o.target,o.anchor,o.customElement),I()}q(h)}class G{$destroy(){N(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const J=new(window.AudioContext||window.webkitAudioContext),K=(t,e,n)=>{const r=J.createGain();r.gain.value=n?.gain??.75,r.connect(J.destination);const o=J.createOscillator();o.frequency.value=t,o.connect(r),n?.onended&&(o.onended=onended),o.start(0),o.stop(J.currentTime+e)};function Q(t,e,n){const r=t.slice();return r[16]=e[n],r[18]=n,r}function U(t,e,n){const r=t.slice();return r[19]=e[n].name,r[20]=e[n].ratio,r}function V(t){let e,n,r,o;return{c(){e=f("text"),n=h("Not a complete circle\n    "),y(e,"x",r=t[2]/2),y(e,"y",o=t[1]/2),y(e,"text-anchor","middle"),y(e,"font-family","monospace"),y(e,"fill","#944"),y(e,"font-size","12")},m(t,r){i(t,e,r),l(e,n)},p(t,n){4&n&&r!==(r=t[2]/2)&&y(e,"x",r),2&n&&o!==(o=t[1]/2)&&y(e,"y",o)},d(t){t&&s(e)}}}function X(t){let e,n=t[12],r=[];for(let e=0;e<n.length;e+=1)r[e]=Y(U(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=p()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);i(t,e,n)},p(t,o){if(5047&o){let c;for(n=t[12],c=0;c<n.length;c+=1){const l=U(t,n,c);r[c]?r[c].p(l,o):(r[c]=Y(l),r[c].c(),r[c].m(e.parentNode,e))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(t){a(r,t),t&&s(e)}}}function Y(t){let e,n,r,o,c,a,u,d,p,m,g,w,$,x,b,M=t[19]+"";return{c(){e=f("line"),a=f("circle"),p=f("rect"),w=f("text"),$=h(M),y(e,"x1",n=t[8]*t[7](t[0]-t[5])[0]+t[2]/2),y(e,"y1",r=t[8]*t[7](t[0]-t[5])[1]+t[1]/2),y(e,"x2",o=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2),y(e,"y2",c=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2),v(e,"stroke","rgba(255,50,50,.6)"),v(e,"stroke-width","4"),y(a,"cx",u=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2),y(a,"cy",d=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2),y(a,"r","14"),y(a,"stroke","rgba(255,50,50,.6)"),y(a,"stroke-width","2"),y(a,"fill","transparent"),y(p,"x",m=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2-10),y(p,"y",g=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2-10),y(p,"width","20"),y(p,"height","20"),v(p,"fill","rgba(255,255,255,.85)"),y(w,"x",x=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2),y(w,"y",b=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2+4),y(w,"text-anchor","middle"),y(w,"font-family","monospace"),y(w,"fill","#52f"),y(w,"font-size","12")},m(t,n){i(t,e,n),i(t,a,n),i(t,p,n),i(t,w,n),l(w,$)},p(t,l){421&l&&n!==(n=t[8]*t[7](t[0]-t[5])[0]+t[2]/2)&&y(e,"x1",n),419&l&&r!==(r=t[8]*t[7](t[0]-t[5])[1]+t[1]/2)&&y(e,"y1",r),437&l&&o!==(o=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2)&&y(e,"x2",o),435&l&&c!==(c=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2)&&y(e,"y2",c),437&l&&u!==(u=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2)&&y(a,"cx",u),435&l&&d!==(d=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2)&&y(a,"cy",d),437&l&&m!==(m=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2-10)&&y(p,"x",m),435&l&&g!==(g=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2-10)&&y(p,"y",g),437&l&&x!==(x=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2)&&y(w,"x",x),435&l&&b!==(b=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2+4)&&y(w,"y",b)},d(t){t&&s(e),t&&s(a),t&&s(p),t&&s(w)}}}function Z(t){let e,n,o,c,a,u,d,p,g,$,v,x,b,M=t[18]*(t[0]-t[4])%t[0]+"";function q(){return t[13](t[18])}function k(){return t[14](t[18])}return{c(){e=f("circle"),u=f("text"),d=h(M),y(e,"data-number",n=(t[0]-t[18])%t[0]),y(e,"data-n",o=t[18]),y(e,"cx",c=t[8]*t[7](t[18])[0]+t[2]/2),y(e,"cy",a=t[8]*t[7](t[18])[1]+t[1]/2),y(e,"r","13"),y(e,"stroke","black"),y(e,"stroke-width","1"),y(e,"fill","rgba(245,245,245,1)"),y(e,"class","svelte-ruof1w"),y(u,"x",p=t[8]*t[7](t[18])[0]+t[2]/2),y(u,"y",g=t[8]*t[7](t[18])[1]+5+t[1]/2),y(u,"data-n",$=t[18]),y(u,"data-number",v=(t[0]-t[18])%t[0]),y(u,"text-anchor","middle"),y(u,"font-family","monospace"),y(u,"fill","#555"),y(u,"font-size","12"),y(u,"class","svelte-ruof1w")},m(n,r){i(n,e,r),i(n,u,r),l(u,d),x||(b=[m(e,"click",q),m(e,"mouseenter",t[10]),m(e,"mouseleave",t[11]),m(u,"click",k),m(u,"mouseenter",t[10]),m(u,"mouseleave",t[11])],x=!0)},p(r,o){t=r,1&o&&n!==(n=(t[0]-t[18])%t[0])&&y(e,"data-number",n),388&o&&c!==(c=t[8]*t[7](t[18])[0]+t[2]/2)&&y(e,"cx",c),386&o&&a!==(a=t[8]*t[7](t[18])[1]+t[1]/2)&&y(e,"cy",a),17&o&&M!==(M=t[18]*(t[0]-t[4])%t[0]+"")&&w(d,M),388&o&&p!==(p=t[8]*t[7](t[18])[0]+t[2]/2)&&y(u,"x",p),386&o&&g!==(g=t[8]*t[7](t[18])[1]+5+t[1]/2)&&y(u,"y",g),1&o&&v!==(v=(t[0]-t[18])%t[0])&&y(u,"data-number",v)},d(t){t&&s(e),t&&s(u),x=!1,r(b)}}}function tt(e){let n,r,o,c,u,h,d=!e[6]&&V(e),m=!1!==e[5]&&X(e),g=Array(e[0]),w=[];for(let t=0;t<g.length;t+=1)w[t]=Z(Q(e,g,t));return{c(){n=f("svg"),r=f("circle"),d&&d.c(),u=p(),m&&m.c(),h=p();for(let t=0;t<w.length;t+=1)w[t].c();y(r,"cx",o=e[2]/2),y(r,"cy",c=e[1]/2),y(r,"r",e[8]),y(r,"stroke","black"),y(r,"stroke-width","2"),y(r,"fill","transparent"),y(n,"width",e[2]),y(n,"height",e[1]),y(n,"class","svelte-ruof1w")},m(t,e){i(t,n,e),l(n,r),d&&d.m(n,null),l(n,u),m&&m.m(n,null),l(n,h);for(let t=0;t<w.length;t+=1)w[t].m(n,null)},p(t,[e]){if(4&e&&o!==(o=t[2]/2)&&y(r,"cx",o),2&e&&c!==(c=t[1]/2)&&y(r,"cy",c),256&e&&y(r,"r",t[8]),t[6]?d&&(d.d(1),d=null):d?d.p(t,e):(d=V(t),d.c(),d.m(n,u)),!1!==t[5]?m?m.p(t,e):(m=X(t),m.c(),m.m(n,h)):m&&(m.d(1),m=null),3487&e){let r;for(g=Array(t[0]),r=0;r<g.length;r+=1){const o=Q(t,g,r);w[r]?w[r].p(o,e):(w[r]=Z(o),w[r].c(),w[r].m(n,null))}for(;r<w.length;r+=1)w[r].d(1);w.length=g.length}4&e&&y(n,"width",t[2]),2&e&&y(n,"height",t[1])},i:t,o:t,d(t){t&&s(n),d&&d.d(),m&&m.d(),a(w,t)}}}function et(t,e,n){let r,o,c;const l=(t,e)=>e?l(e,t%e):t;let{semitones:i}=e,{height:s}=e,{width:a}=e,{frequencyRoot:u=440}=e;const f=t=>i*Math.log2(t);let{generator:h=Math.round(f(1.5))}=e,d=!1;return t.$$set=t=>{"semitones"in t&&n(0,i=t.semitones),"height"in t&&n(1,s=t.height),"width"in t&&n(2,a=t.width),"frequencyRoot"in t&&n(3,u=t.frequencyRoot),"generator"in t&&n(4,h=t.generator)},t.$$.update=()=>{6&t.$$.dirty&&n(8,r=Math.min(s,a)/2-20),1&t.$$.dirty&&n(7,o=t=>[-Math.sin(t%i*2*Math.PI/i),-Math.cos(t%i*2*Math.PI/i)]),17&t.$$.dirty&&n(6,c=1===l(i,h))},[i,s,a,u,h,d,c,o,r,f,function(t){n(5,d=t.target.attributes["data-number"]?.value??!1)},function(t){n(5,d=!1)},[{name:"P4",ratio:4/3},{name:"P5",ratio:1.5},{name:"M3",ratio:5/4}],t=>K(u*2**(t/i),1),t=>K(u*2**(t/i),1)]}class nt extends G{constructor(t){super(),L(this,t,et,tt,c,{semitones:0,height:1,width:2,frequencyRoot:3,generator:4})}}function rt(e){let n,r;return{c(){n=u("canvas"),y(n,"height",r=2*e[0]),y(n,"class","svelte-q1vgj0")},m(t,r){i(t,n,r),e[8](n)},p(t,[e]){1&e&&r!==(r=2*t[0])&&y(n,"height",r)},i:t,o:t,d(t){t&&s(n),e[8](null)}}}const ot=1e5;function ct(t,e,n){let r,o,c,l,{scaleBinary:i}=e,{frequencyRoot:s=440}=e,{semitones:a=12}=e,{width:u=1e3}=e,{height:f=300}=e;const h=["FF8A80","B388FF","80D8FF","B9F6CA","FFFF8D","FF9E80","8D6E63"];var d;return d=()=>{n(1,l.width=2*u,l),n(1,l.height=2*f,l)},k().$$.on_mount.push(d),function(t){k().$$.after_update.push(t)}((()=>{c()})),t.$$set=t=>{"scaleBinary"in t&&n(2,i=t.scaleBinary),"frequencyRoot"in t&&n(3,s=t.frequencyRoot),"semitones"in t&&n(4,a=t.semitones),"width"in t&&n(5,u=t.width),"height"in t&&n(0,f=t.height)},t.$$.update=()=>{16&t.$$.dirty&&n(7,r=t=>2**(t/a)),148&t.$$.dirty&&n(6,o=i.padEnd(a+1,"0").split("").map(((t,e)=>["1"===t||"x"===t,r(e)]))),74&t.$$.dirty&&(c=()=>{const t=l.getContext("2d");t.clearRect(0,0,l.width,l.height),[].forEach(((e,n)=>{let r=0,o=0;for(;o<l.width;)t.beginPath(),t.lineWidth="2",t.strokeStyle="#"+h[n%h.length],o=Math.round(r*ot/s/2*e),t.moveTo(o+.5,Math.round(l.height/2)-20),t.lineTo(o+.5,Math.round(l.height/2)+20),t.stroke(),t.lineWidth=1,r++}));var e=new Date;t.beginPath(),t.lineWidth="1.5",t.strokeStyle="grey",t.moveTo(0,Math.round(l.height/2)),t.lineTo(l.width,Math.round(l.height/2)),t.stroke(),o.filter((([t,e])=>t)).forEach((([e,n],r)=>{var o;((t,e,n)=>{let r=0;t.beginPath();for(let o=0;o<l.width-1;++o){const c=e(o/ot)*l.height/2.2;let i=l.height/2;t.lineWidth="1.5",t.strokeStyle=n,t.moveTo(o,i-r),t.lineTo(o+1,i-c),r=c}t.stroke()})(t,(o=n*s,t=>Math.sin(t*o*Math.PI*2)),"#"+h[r%h.length])}));var n=new Date-e;console.log("elapsed time = "+n+" ms")})},[f,l,i,s,a,u,o,r,function(t){_[t?"unshift":"push"]((()=>{l=t,n(1,l)}))}]}class lt extends G{constructor(t){super(),L(this,t,ct,rt,c,{scaleBinary:2,frequencyRoot:3,semitones:4,width:5,height:0})}}function it(t,e,n){const r=t.slice();return r[6]=e[n].selected,r[7]=e[n].freq,r[9]=n,r}function st(t,e,n){const r=t.slice();return r[10]=e[n][0],r[11]=e[n][1],r[9]=n,r}function at(t){let e,n,r;return{c(){e=f("rect"),y(e,"opacity","1"),y(e,"fill","#039BE5"),y(e,"width","4"),y(e,"height",ht),y(e,"y",n=(t[11]-1)*ht),y(e,"x",r=(t[10]/t[11]-1)*(t[4]-5)),y(e,"tabindex","-1")},m(t,n){i(t,e,n)},p(t,o){4&o&&n!==(n=(t[11]-1)*ht)&&y(e,"y",n),20&o&&r!==(r=(t[10]/t[11]-1)*(t[4]-5))&&y(e,"x",r)},d(t){t&&s(e)}}}function ut(t){let e,n,r,o,c,a,u,d,p,m,g,$,v,x=Math.round(t[7])+"";return{c(){e=f("rect"),c=f("text"),a=h(x),u=h(" hz\n      "),p=f("text"),m=h(t[9]),y(e,"opacity",n=t[6]?.75:.25),y(e,"fill","#FF5722"),y(e,"width","2"),y(e,"height",r=t[0]*ht),y(e,"y","0"),y(e,"x",o=(t[7]-t[1])*(t[4]-5)/t[1]+1),y(e,"tabindex","-1"),y(c,"x","0"),y(c,"y","-9"),y(c,"font-family","monospace"),y(c,"transform",d="translate("+((t[7]-t[1])*(t[4]-5)/t[1]-1)+", 0) rotate(90)"),y(c,"font-size","10"),y(p,"x",g=(t[7]-t[1])*(t[4]-5)/t[1]-1),y(p,"y",$=(t[0]+1.2)*ht),y(p,"opacity",v=t[6]?1:.5),y(p,"transform","translate(, 0) rotate(90)"),y(p,"font-family","monospace"),y(p,"font-size","10")},m(t,n){i(t,e,n),i(t,c,n),l(c,a),l(c,u),i(t,p,n),l(p,m)},p(t,l){8&l&&n!==(n=t[6]?.75:.25)&&y(e,"opacity",n),1&l&&r!==(r=t[0]*ht)&&y(e,"height",r),26&l&&o!==(o=(t[7]-t[1])*(t[4]-5)/t[1]+1)&&y(e,"x",o),8&l&&x!==(x=Math.round(t[7])+"")&&w(a,x),26&l&&d!==(d="translate("+((t[7]-t[1])*(t[4]-5)/t[1]-1)+", 0) rotate(90)")&&y(c,"transform",d),26&l&&g!==(g=(t[7]-t[1])*(t[4]-5)/t[1]-1)&&y(p,"x",g),1&l&&$!==($=(t[0]+1.2)*ht)&&y(p,"y",$),8&l&&v!==(v=t[6]?1:.5)&&y(p,"opacity",v)},d(t){t&&s(e),t&&s(c),t&&s(p)}}}function ft(e){let n,r,o,c=e[2],u=[];for(let t=0;t<c.length;t+=1)u[t]=at(st(e,c,t));let h=e[3],d=[];for(let t=0;t<h.length;t+=1)d[t]=ut(it(e,h,t));return{c(){n=f("svg"),r=f("g");for(let t=0;t<u.length;t+=1)u[t].c();o=p();for(let t=0;t<d.length;t+=1)d[t].c();y(r,"transform","translate(1, 0)"),y(n,"width",e[4]),y(n,"height",e[5])},m(t,e){i(t,n,e),l(n,r);for(let t=0;t<u.length;t+=1)u[t].m(r,null);l(r,o);for(let t=0;t<d.length;t+=1)d[t].m(r,null)},p(t,[e]){if(20&e){let n;for(c=t[2],n=0;n<c.length;n+=1){const l=st(t,c,n);u[n]?u[n].p(l,e):(u[n]=at(l),u[n].c(),u[n].m(r,o))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}if(27&e){let n;for(h=t[3],n=0;n<h.length;n+=1){const o=it(t,h,n);d[n]?d[n].p(o,e):(d[n]=ut(o),d[n].c(),d[n].m(r,null))}for(;n<d.length;n+=1)d[n].d(1);d.length=h.length}16&e&&y(n,"width",t[4])},i:t,o:t,d(t){t&&s(n),a(u,t),a(d,t)}}}let ht=12;function dt(t,e,n){let{fareySequenceOrder:r}=e,{frequencyRoot:o}=e,{fareySequence:c}=e,{frequencyInfos:l}=e,{width:i=500}=e,s=(r+1.5)*ht;return t.$$set=t=>{"fareySequenceOrder"in t&&n(0,r=t.fareySequenceOrder),"frequencyRoot"in t&&n(1,o=t.frequencyRoot),"fareySequence"in t&&n(2,c=t.fareySequence),"frequencyInfos"in t&&n(3,l=t.frequencyInfos),"width"in t&&n(4,i=t.width)},[r,o,c,l,i,s]}class pt extends G{constructor(t){super(),L(this,t,dt,ft,c,{fareySequenceOrder:0,frequencyRoot:1,fareySequence:2,frequencyInfos:3,width:4})}}function mt(t,e,n){const r=t.slice();return r[21]=e[n].selected,r[22]=e[n].freq,r[23]=e[n].farey,r[24]=e[n].fareyError,r[25]=e[n].fareyErrorAbs,r[27]=n,r}function yt(t){let e,n,r,o,c,a,f,p,g,$,v,x,b,M,q,k,E,_,F,S,R,z,C,A,P,I,T=(t[22]?Math.round(100*t[22])/100:"")+"",O=t[23].join("/")+"",B=Math.round(1e4*t[24])/100+"",H=Math.round(100*t[25])/100+"";function j(){return t[16](t[22])}return{c(){e=u("tr"),n=u("td"),r=h(t[27]),o=d(),c=u("td"),a=h(T),f=d(),p=u("small"),p.textContent="Hz",g=d(),$=u("button"),$.textContent="▶",v=d(),x=u("td"),b=h(O),M=d(),q=u("td"),k=h(B),E=u("small"),E.textContent="%",_=d(),F=u("small"),S=h("("),R=h(H),z=h(" Hz)"),C=d(),y(n,"class","svelte-1c1wp76"),y($,"class","btn-play svelte-1c1wp76"),y(c,"class","svelte-1c1wp76"),y(x,"class","svelte-1c1wp76"),y(q,"class","svelte-1c1wp76"),y(e,"style",A=t[21]?"":"opacity: .6")},m(t,s){i(t,e,s),l(e,n),l(n,r),l(e,o),l(e,c),l(c,a),l(c,f),l(c,p),l(c,g),l(c,$),l(e,v),l(e,x),l(x,b),l(e,M),l(e,q),l(q,k),l(q,E),l(q,_),l(q,F),l(F,S),l(F,R),l(F,z),l(e,C),P||(I=m($,"click",j),P=!0)},p(n,r){t=n,16&r&&T!==(T=(t[22]?Math.round(100*t[22])/100:"")+"")&&w(a,T),16&r&&O!==(O=t[23].join("/")+"")&&w(b,O),16&r&&B!==(B=Math.round(1e4*t[24])/100+"")&&w(k,B),16&r&&H!==(H=Math.round(100*t[25])/100+"")&&w(R,H),16&r&&A!==(A=t[21]?"":"opacity: .6")&&y(e,"style",A)},d(t){t&&s(e),P=!1,I()}}}function gt(t){let e,n,o,c,f,p,v,x,b,q,k,E,_,F,S,R,z,A,P,I,T,O,D,L,G,J,K,Q,U,V,X,Y,Z,tt,et,rt,ot,ct,it,st,at,ut,ft,ht,dt,gt,wt,$t,vt,xt,bt,Mt,qt,kt,Et,_t,Ft,St,Rt,zt,Ct,At,Pt,It,Tt,Ot,Bt,Ht,jt,Wt,Nt,Dt,Lt,Gt,Jt,Kt,Qt,Ut,Vt,Xt,Yt,Zt,te,ee,ne,re,oe,ce,le,ie,se=Math.round(1e4*t[8].avgError)/100+"",ae=Math.round(1e4*t[8].maxError)/100+"",ue=3*t[1]/2+"",fe=4*t[1]/3+"",he=5*t[1]/4+"";o=new lt({props:{frequencyRoot:t[1],semitones:t[2],scaleBinary:t[3],width:t[6]}});let de=t[4],pe=[];for(let e=0;e<de.length;e+=1)pe[e]=yt(mt(t,de,e));return Pt=new nt({props:{width:t[6]>1e3?t[6]/2:280,height:t[6]>1e3?t[6]/3:280,frequencyInfos:t[4],semitones:t[2],generator:t[7],frequencyRoot:t[1]}}),Nt=new pt({props:{fareySequenceOrder:t[0],frequencyRoot:t[1],fareySequence:t[5],frequencyInfos:t[4],width:t[6]>1e3?t[6]/2:t[6]}}),{c(){e=u("h1"),e.textContent="Equal temperament playground",n=d(),j(o.$$.fragment),c=d(),f=u("div"),p=u("span"),v=h("Scale: "),x=u("input"),b=d(),q=u("span"),k=h("Fundamental frequency ("),E=u("em"),E.textContent="hz",_=h("): "),F=u("input"),S=d(),R=u("span"),z=h("Semi-tones: "),A=u("input"),P=d(),I=u("span"),T=h("Farey sequence order: "),O=u("input"),D=d(),L=u("div"),G=u("div"),J=u("div"),K=u("table"),Q=u("thead"),U=u("tr"),V=u("th"),X=d(),Y=u("th"),Z=d(),tt=u("th"),et=h("Farey order "),rt=h(t[0]),ot=d(),ct=u("tr"),ct.innerHTML='<th scope="col" class="svelte-1c1wp76">Semi-<br/>tone</th> \n            <th scope="col" class="svelte-1c1wp76">Frequency<br/>(Hz)</th> \n            <th scope="col" class="svelte-1c1wp76">Ratio</th> \n            <th scope="col" class="svelte-1c1wp76">Error<br/>(Hz)</th>',it=d(),st=u("tbody");for(let t=0;t<pe.length;t+=1)pe[t].c();at=d(),ut=u("tfoot"),ft=u("tr"),ht=u("th"),dt=d(),gt=u("th"),wt=d(),$t=u("th"),vt=d(),xt=u("th"),bt=h("Avg(error) = "),Mt=h(se),qt=u("small"),qt.textContent="%",kt=u("br"),Et=h("\n              Max(error) = "),_t=h(ae),Ft=u("small"),Ft.textContent="%",St=d(),Rt=u("div"),zt=u("div"),Ct=u("h4"),Ct.innerHTML='<a href="https://en.wikipedia.org/wiki/Circle_of_fifths">Circle of fifths</a>',At=d(),j(Pt.$$.fragment),It=u("br"),Tt=h("\n        Generator: "),Ot=u("input"),Bt=d(),Ht=u("div"),jt=u("h4"),jt.innerHTML='<a href="https://en.wikipedia.org/wiki/Farey_sequence">Farey sequence pattern</a>',Wt=d(),j(Nt.$$.fragment),Dt=d(),Lt=u("div"),Gt=u("p"),Jt=h("Perfect fifth: "),Kt=h(ue),Qt=h(" Hz"),Ut=u("br"),Vt=h("\n          Perfect fourth: "),Xt=h(fe),Yt=h(" Hz"),Zt=u("br"),te=h("\n          Major third: "),ee=h(he),ne=h(" Hz"),re=u("br"),y(e,"class","svelte-1c1wp76"),y(x,"type","text"),y(x,"maxlength",t[2]),y(p,"class","svelte-1c1wp76"),y(F,"type","number"),y(F,"class","svelte-1c1wp76"),y(q,"class","svelte-1c1wp76"),y(A,"type","number"),y(A,"class","svelte-1c1wp76"),y(R,"class","svelte-1c1wp76"),y(O,"type","number"),y(O,"min","2"),y(O,"max","200"),y(O,"class","svelte-1c1wp76"),y(I,"class","svelte-1c1wp76"),y(f,"class","row main-inputs svelte-1c1wp76"),y(V,"scope","col"),y(V,"class","svelte-1c1wp76"),y(Y,"scope","col"),y(Y,"class","svelte-1c1wp76"),y(tt,"scope","col"),y(tt,"colspan","3"),y(tt,"class","svelte-1c1wp76"),y(Q,"class","svelte-1c1wp76"),y(ht,"scope","col"),y(ht,"class","svelte-1c1wp76"),y(gt,"scope","col"),y(gt,"class","svelte-1c1wp76"),y($t,"scope","col"),y($t,"class","svelte-1c1wp76"),y(xt,"scope","col"),y(xt,"class","svelte-1c1wp76"),y(ut,"class","svelte-1c1wp76"),y(K,"class","svelte-1c1wp76"),y(J,"class","column svelte-1c1wp76"),y(Ot,"class","input-small svelte-1c1wp76"),y(Ot,"type","number"),y(Ot,"max","199"),y(zt,"id","tone-circle"),y(Ht,"id","farey-sequence-pattern"),y(Rt,"class","column svelte-1c1wp76"),y(G,"class","row svelte-1c1wp76"),C((()=>t[18].call(G))),y(L,"class","main")},m(r,a){i(r,e,a),i(r,n,a),W(o,r,a),i(r,c,a),i(r,f,a),l(f,p),l(p,v),l(p,x),$(x,t[3]),l(f,b),l(f,q),l(q,k),l(q,E),l(q,_),l(q,F),$(F,t[1]),l(f,S),l(f,R),l(R,z),l(R,A),$(A,t[2]),l(f,P),l(f,I),l(I,T),l(I,O),$(O,t[0]),i(r,D,a),i(r,L,a),l(L,G),l(G,J),l(J,K),l(K,Q),l(Q,U),l(U,V),l(U,X),l(U,Y),l(U,Z),l(U,tt),l(tt,et),l(tt,rt),l(Q,ot),l(Q,ct),l(K,it),l(K,st);for(let t=0;t<pe.length;t+=1)pe[t].m(st,null);l(K,at),l(K,ut),l(ut,ft),l(ft,ht),l(ft,dt),l(ft,gt),l(ft,wt),l(ft,$t),l(ft,vt),l(ft,xt),l(xt,bt),l(xt,Mt),l(xt,qt),l(xt,kt),l(xt,Et),l(xt,_t),l(xt,Ft),l(G,St),l(G,Rt),l(Rt,zt),l(zt,Ct),l(zt,At),W(Pt,zt,null),l(zt,It),l(zt,Tt),l(zt,Ot),$(Ot,t[7]),l(Rt,Bt),l(Rt,Ht),l(Ht,jt),l(Ht,Wt),W(Nt,Ht,null),l(Rt,Dt),l(Rt,Lt),l(Lt,Gt),l(Gt,Jt),l(Gt,Kt),l(Gt,Qt),l(Gt,Ut),l(Gt,Vt),l(Gt,Xt),l(Gt,Yt),l(Gt,Zt),l(Gt,te),l(Gt,ee),l(Gt,ne),l(Gt,re),oe=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=u("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=M();let o;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=m(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{o=m(n.contentWindow,"resize",e)}),l(t,n),()=>{(r||o&&n.contentWindow)&&o(),s(n)}}(G,t[18].bind(G)),ce=!0,le||(ie=[m(x,"input",t[12]),m(F,"input",t[13]),m(A,"input",t[14]),m(O,"input",t[15]),m(Ot,"input",t[17])],le=!0)},p(t,[e]){const n={};if(2&e&&(n.frequencyRoot=t[1]),4&e&&(n.semitones=t[2]),8&e&&(n.scaleBinary=t[3]),64&e&&(n.width=t[6]),o.$set(n),(!ce||4&e)&&y(x,"maxlength",t[2]),8&e&&x.value!==t[3]&&$(x,t[3]),2&e&&g(F.value)!==t[1]&&$(F,t[1]),4&e&&g(A.value)!==t[2]&&$(A,t[2]),1&e&&g(O.value)!==t[0]&&$(O,t[0]),(!ce||1&e)&&w(rt,t[0]),16&e){let n;for(de=t[4],n=0;n<de.length;n+=1){const r=mt(t,de,n);pe[n]?pe[n].p(r,e):(pe[n]=yt(r),pe[n].c(),pe[n].m(st,null))}for(;n<pe.length;n+=1)pe[n].d(1);pe.length=de.length}(!ce||256&e)&&se!==(se=Math.round(1e4*t[8].avgError)/100+"")&&w(Mt,se),(!ce||256&e)&&ae!==(ae=Math.round(1e4*t[8].maxError)/100+"")&&w(_t,ae);const r={};64&e&&(r.width=t[6]>1e3?t[6]/2:280),64&e&&(r.height=t[6]>1e3?t[6]/3:280),16&e&&(r.frequencyInfos=t[4]),4&e&&(r.semitones=t[2]),128&e&&(r.generator=t[7]),2&e&&(r.frequencyRoot=t[1]),Pt.$set(r),128&e&&g(Ot.value)!==t[7]&&$(Ot,t[7]);const c={};1&e&&(c.fareySequenceOrder=t[0]),2&e&&(c.frequencyRoot=t[1]),32&e&&(c.fareySequence=t[5]),16&e&&(c.frequencyInfos=t[4]),64&e&&(c.width=t[6]>1e3?t[6]/2:t[6]),Nt.$set(c),(!ce||2&e)&&ue!==(ue=3*t[1]/2+"")&&w(Kt,ue),(!ce||2&e)&&fe!==(fe=4*t[1]/3+"")&&w(Xt,fe),(!ce||2&e)&&he!==(he=5*t[1]/4+"")&&w(ee,he)},i(t){ce||(B(o.$$.fragment,t),B(Pt.$$.fragment,t),B(Nt.$$.fragment,t),ce=!0)},o(t){H(o.$$.fragment,t),H(Pt.$$.fragment,t),H(Nt.$$.fragment,t),ce=!1},d(t){t&&s(e),t&&s(n),N(o,t),t&&s(c),t&&s(f),t&&s(D),t&&s(L),a(pe,t),N(Pt),N(Nt),oe(),le=!1,r(ie)}}}function wt(t,e,n){let r,o,c,l,i,s,a;const u=(t,e)=>{let n=null,r=null;return t.forEach((([t,o])=>{let c=Math.abs(t/o-e);(null===n||c<n)&&(n=c,r=[t,o])})),r};let f,h=15,d=440,p=12,m="101101011010";return t.$$.update=()=>{1&t.$$.dirty&&n(5,r=(t=>{let e={};for(let n=1;n<=t;++n)for(let t=0;t<=n;++t){let r=Math.round(t/n*1e4)/1e4;e[r]=e[r]??[t+n,n]}return Object.values(e).sort((([t,e],[n,r])=>t/e-n/r))})(h)),4&t.$$.dirty&&n(11,o=t=>2**(t/p)),2060&t.$$.dirty&&n(10,c=m.padEnd(p+1,"0").split("").map(((t,e)=>["1"===t||"x"===t,o(e)]))),34&t.$$.dirty&&n(9,l=([t,e])=>{const n={selected:t,normalizedFreq:e-1,freq:e*d,farey:u(r,e)};return n.fareyError=1-1/e*n.farey[0]/n.farey[1],n.fareyErrorAbs=e*d-d*n.farey[0]/n.farey[1],n}),1536&t.$$.dirty&&n(4,i=c.map(l)),20&t.$$.dirty&&n(8,s=(()=>{console.log(1);let t=null,e=0;return i.forEach((({freq:n,fareyError:r})=>{t=Math.max(t,r),e+=Math.abs(r)})),{maxError:t,avgError:e/p}})())},n(7,a=7),[h,d,p,m,i,r,f,a,s,l,c,o,function(){m=this.value,n(3,m)},function(){d=g(this.value),n(1,d)},function(){p=g(this.value),n(2,p)},function(){h=g(this.value),n(0,h)},t=>K(t,1),function(){a=g(this.value),n(7,a)},function(){f=this.clientWidth,n(6,f)}]}return new class extends G{constructor(t){super(),L(this,t,wt,gt,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
