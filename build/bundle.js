var app=function(){"use strict";function t(){}function e(t){return t()}function n(){return Object.create(null)}function r(t){t.forEach(e)}function o(t){return"function"==typeof t}function c(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}function l(t,e){t.appendChild(e)}function s(t,e,n){t.insertBefore(e,n||null)}function a(t){t.parentNode.removeChild(t)}function i(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function u(t){return document.createElement(t)}function f(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function d(t){return document.createTextNode(t)}function h(){return d(" ")}function m(){return d("")}function p(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function y(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function g(t){return""===t?null:+t}function $(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function v(t,e){t.value=null==e?"":e}function x(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}let w,b;function M(){if(void 0===w){w=!1;try{"undefined"!=typeof window&&window.parent&&window.parent.document}catch(t){w=!0}}return w}function q(t){b=t}function k(t){(function(){if(!b)throw new Error("Function called outside component initialization");return b})().$$.after_update.push(t)}const E=[],F=[],S=[],_=[],R=Promise.resolve();let z=!1;function C(t){S.push(t)}const A=new Set;let P=0;function I(){const t=b;do{for(;P<E.length;){const t=E[P];P++,q(t),O(t.$$)}for(q(null),E.length=0,P=0;F.length;)F.pop()();for(let t=0;t<S.length;t+=1){const e=S[t];A.has(e)||(A.add(e),e())}S.length=0}while(E.length);for(;_.length;)_.pop()();z=!1,A.clear(),q(t)}function O(t){if(null!==t.fragment){t.update(),r(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(C)}}const T=new Set;function B(t,e){t&&t.i&&(T.delete(t),t.i(e))}function H(t,e,n,r){if(t&&t.o){if(T.has(t))return;T.add(t),undefined.c.push((()=>{T.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}}function W(t){t&&t.c()}function j(t,n,c,l){const{fragment:s,on_mount:a,on_destroy:i,after_update:u}=t.$$;s&&s.m(n,c),l||C((()=>{const n=a.map(e).filter(o);i?i.push(...n):r(n),t.$$.on_mount=[]})),u.forEach(C)}function N(t,e){const n=t.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function D(t,e){-1===t.$$.dirty[0]&&(E.push(t),z||(z=!0,R.then(I)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function L(e,o,c,l,s,i,u,f=[-1]){const d=b;q(e);const h=e.$$={fragment:null,ctx:null,props:i,update:t,not_equal:s,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(d?d.$$.context:[])),callbacks:n(),dirty:f,skip_bound:!1,root:o.target||d.$$.root};u&&u(h.root);let m=!1;if(h.ctx=c?c(e,o.props||{},((t,n,...r)=>{const o=r.length?r[0]:n;return h.ctx&&s(h.ctx[t],h.ctx[t]=o)&&(!h.skip_bound&&h.bound[t]&&h.bound[t](o),m&&D(e,t)),n})):[],h.update(),m=!0,r(h.before_update),h.fragment=!!l&&l(h.ctx),o.target){if(o.hydrate){const t=function(t){return Array.from(t.childNodes)}(o.target);h.fragment&&h.fragment.l(t),t.forEach(a)}else h.fragment&&h.fragment.c();o.intro&&B(e.$$.fragment),j(e,o.target,o.anchor,o.customElement),I()}q(d)}class G{$destroy(){N(this,1),this.$destroy=t}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const J=new(window.AudioContext||window.webkitAudioContext),K=(t,e,n)=>{const r=J.createGain();r.gain.value=n?.gain??.75,r.connect(J.destination);const o=J.createOscillator();o.frequency.value=t,o.connect(r),n?.onended&&(o.onended=onended),o.start(0),o.stop(J.currentTime+e)};function Q(t,e,n){const r=t.slice();return r[16]=e[n],r[18]=n,r}function U(t,e,n){const r=t.slice();return r[19]=e[n].name,r[20]=e[n].ratio,r}function V(t){let e,n,r,o;return{c(){e=f("text"),n=d("Not a complete circle\n    "),y(e,"x",r=t[2]/2),y(e,"y",o=t[1]/2),y(e,"text-anchor","middle"),y(e,"font-family","monospace"),y(e,"fill","#944"),y(e,"font-size","12")},m(t,r){s(t,e,r),l(e,n)},p(t,n){4&n&&r!==(r=t[2]/2)&&y(e,"x",r),2&n&&o!==(o=t[1]/2)&&y(e,"y",o)},d(t){t&&a(e)}}}function X(t){let e,n=t[12],r=[];for(let e=0;e<n.length;e+=1)r[e]=Y(U(t,n,e));return{c(){for(let t=0;t<r.length;t+=1)r[t].c();e=m()},m(t,n){for(let e=0;e<r.length;e+=1)r[e].m(t,n);s(t,e,n)},p(t,o){if(5047&o){let c;for(n=t[12],c=0;c<n.length;c+=1){const l=U(t,n,c);r[c]?r[c].p(l,o):(r[c]=Y(l),r[c].c(),r[c].m(e.parentNode,e))}for(;c<r.length;c+=1)r[c].d(1);r.length=n.length}},d(t){i(r,t),t&&a(e)}}}function Y(t){let e,n,r,o,c,i,u,h,m,p,g,$,v,w,b,M=t[19]+"";return{c(){e=f("line"),i=f("circle"),m=f("rect"),$=f("text"),v=d(M),y(e,"x1",n=t[8]*t[7](t[0]-t[5])[0]+t[2]/2),y(e,"y1",r=t[8]*t[7](t[0]-t[5])[1]+t[1]/2),y(e,"x2",o=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2),y(e,"y2",c=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2),x(e,"stroke","rgba(255,50,50,.6)"),x(e,"stroke-width","4"),y(i,"cx",u=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2),y(i,"cy",h=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2),y(i,"r","14"),y(i,"stroke","rgba(255,50,50,.6)"),y(i,"stroke-width","2"),y(i,"fill","transparent"),y(m,"x",p=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2-10),y(m,"y",g=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2-10),y(m,"width","20"),y(m,"height","20"),x(m,"fill","rgba(255,255,255,.85)"),y($,"x",w=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2),y($,"y",b=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2+4),y($,"text-anchor","middle"),y($,"font-family","monospace"),y($,"fill","#52f"),y($,"font-size","12")},m(t,n){s(t,e,n),s(t,i,n),s(t,m,n),s(t,$,n),l($,v)},p(t,l){421&l&&n!==(n=t[8]*t[7](t[0]-t[5])[0]+t[2]/2)&&y(e,"x1",n),419&l&&r!==(r=t[8]*t[7](t[0]-t[5])[1]+t[1]/2)&&y(e,"y1",r),437&l&&o!==(o=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2)&&y(e,"x2",o),435&l&&c!==(c=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2)&&y(e,"y2",c),437&l&&u!==(u=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[0]+t[2]/2)&&y(i,"cx",u),435&l&&h!==(h=t[8]*t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20])))[1]+t[1]/2)&&y(i,"cy",h),437&l&&p!==(p=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2-10)&&y(m,"x",p),435&l&&g!==(g=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2-10)&&y(m,"y",g),437&l&&w!==(w=t[8]*(t[7](t[0]-t[5])[0]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[0])/2+t[2]/2)&&y($,"x",w),435&l&&b!==(b=t[8]*(t[7](t[0]-t[5])[1]+t[7](t[0]-t[5]-t[4]*Math.round(t[9](t[20]))%t[0]+t[0])[1])/2+t[1]/2+4)&&y($,"y",b)},d(t){t&&a(e),t&&a(i),t&&a(m),t&&a($)}}}function Z(t){let e,n,o,c,i,u,h,m,g,v,x,w,b,M=t[18]*(t[0]-t[4])%t[0]+"";function q(){return t[13](t[18])}function k(){return t[14](t[18])}return{c(){e=f("circle"),u=f("text"),h=d(M),y(e,"data-number",n=(t[0]-t[18])%t[0]),y(e,"data-n",o=t[18]),y(e,"cx",c=t[8]*t[7](t[18])[0]+t[2]/2),y(e,"cy",i=t[8]*t[7](t[18])[1]+t[1]/2),y(e,"r","13"),y(e,"stroke","black"),y(e,"stroke-width","1"),y(e,"fill","rgba(245,245,245,1)"),y(e,"class","svelte-ruof1w"),y(u,"x",m=t[8]*t[7](t[18])[0]+t[2]/2),y(u,"y",g=t[8]*t[7](t[18])[1]+5+t[1]/2),y(u,"data-n",v=t[18]),y(u,"data-number",x=(t[0]-t[18])%t[0]),y(u,"text-anchor","middle"),y(u,"font-family","monospace"),y(u,"fill","#555"),y(u,"font-size","12"),y(u,"class","svelte-ruof1w")},m(n,r){s(n,e,r),s(n,u,r),l(u,h),w||(b=[p(e,"click",q),p(e,"mouseenter",t[10]),p(e,"mouseleave",t[11]),p(u,"click",k),p(u,"mouseenter",t[10]),p(u,"mouseleave",t[11])],w=!0)},p(r,o){t=r,1&o&&n!==(n=(t[0]-t[18])%t[0])&&y(e,"data-number",n),388&o&&c!==(c=t[8]*t[7](t[18])[0]+t[2]/2)&&y(e,"cx",c),386&o&&i!==(i=t[8]*t[7](t[18])[1]+t[1]/2)&&y(e,"cy",i),17&o&&M!==(M=t[18]*(t[0]-t[4])%t[0]+"")&&$(h,M),388&o&&m!==(m=t[8]*t[7](t[18])[0]+t[2]/2)&&y(u,"x",m),386&o&&g!==(g=t[8]*t[7](t[18])[1]+5+t[1]/2)&&y(u,"y",g),1&o&&x!==(x=(t[0]-t[18])%t[0])&&y(u,"data-number",x)},d(t){t&&a(e),t&&a(u),w=!1,r(b)}}}function tt(e){let n,r,o,c,u,d,h=!e[6]&&V(e),p=!1!==e[5]&&X(e),g=Array(e[0]),$=[];for(let t=0;t<g.length;t+=1)$[t]=Z(Q(e,g,t));return{c(){n=f("svg"),r=f("circle"),h&&h.c(),u=m(),p&&p.c(),d=m();for(let t=0;t<$.length;t+=1)$[t].c();y(r,"cx",o=e[2]/2),y(r,"cy",c=e[1]/2),y(r,"r",e[8]),y(r,"stroke","black"),y(r,"stroke-width","2"),y(r,"fill","transparent"),y(n,"width",e[2]),y(n,"height",e[1]),y(n,"class","svelte-ruof1w")},m(t,e){s(t,n,e),l(n,r),h&&h.m(n,null),l(n,u),p&&p.m(n,null),l(n,d);for(let t=0;t<$.length;t+=1)$[t].m(n,null)},p(t,[e]){if(4&e&&o!==(o=t[2]/2)&&y(r,"cx",o),2&e&&c!==(c=t[1]/2)&&y(r,"cy",c),256&e&&y(r,"r",t[8]),t[6]?h&&(h.d(1),h=null):h?h.p(t,e):(h=V(t),h.c(),h.m(n,u)),!1!==t[5]?p?p.p(t,e):(p=X(t),p.c(),p.m(n,d)):p&&(p.d(1),p=null),3487&e){let r;for(g=Array(t[0]),r=0;r<g.length;r+=1){const o=Q(t,g,r);$[r]?$[r].p(o,e):($[r]=Z(o),$[r].c(),$[r].m(n,null))}for(;r<$.length;r+=1)$[r].d(1);$.length=g.length}4&e&&y(n,"width",t[2]),2&e&&y(n,"height",t[1])},i:t,o:t,d(t){t&&a(n),h&&h.d(),p&&p.d(),i($,t)}}}function et(t,e,n){let r,o,c;const l=(t,e)=>e?l(e,t%e):t;let{semitones:s}=e,{height:a}=e,{width:i}=e,{frequencyRoot:u=440}=e;const f=t=>s*Math.log2(t);let d,{generator:h=Math.round(f(1.5))}=e;return t.$$set=t=>{"semitones"in t&&n(0,s=t.semitones),"height"in t&&n(1,a=t.height),"width"in t&&n(2,i=t.width),"frequencyRoot"in t&&n(3,u=t.frequencyRoot),"generator"in t&&n(4,h=t.generator)},t.$$.update=()=>{6&t.$$.dirty&&n(8,r=Math.min(a,i)/2-20),1&t.$$.dirty&&n(7,o=t=>[-Math.sin(t%s*2*Math.PI/s),-Math.cos(t%s*2*Math.PI/s)]),17&t.$$.dirty&&n(6,c=1===l(s,h))},[s,a,i,u,h,d,c,o,r,f,function(t){n(5,d=t.target.attributes["data-number"]?.value??!1)},function(t){n(5,d=!1)},[{name:"P4",ratio:4/3},{name:"P5",ratio:1.5},{name:"M3",ratio:5/4}],t=>K(u*2**(t/s),1),t=>K(u*2**(t/s),1)]}class nt extends G{constructor(t){super(),L(this,t,et,tt,c,{semitones:0,height:1,width:2,frequencyRoot:3,generator:4})}}function rt(e){let n;return{c(){n=u("canvas"),y(n,"width",1500),y(n,"height",500),y(n,"class","svelte-1bkyttm")},m(t,r){s(t,n,r),e[6](n)},p:t,i:t,o:t,d(t){t&&a(n),e[6](null)}}}function ot(t,e,n){let r,o,c,l,{scaleBinary:s}=e,{frequencyRoot:a=440}=e,{semitones:i=12}=e;const u=["FF8A80","B388FF","80D8FF","B9F6CA","FFFF8D","FF9E80","8D6E63"];return k((()=>{c()})),t.$$set=t=>{"scaleBinary"in t&&n(1,s=t.scaleBinary),"frequencyRoot"in t&&n(2,a=t.frequencyRoot),"semitones"in t&&n(3,i=t.semitones)},t.$$.update=()=>{8&t.$$.dirty&&n(5,r=t=>2**(t/i)),42&t.$$.dirty&&n(4,o=s.padEnd(i+1,"0").split("").map(((t,e)=>["1"===t||"x"===t,r(e)]))),21&t.$$.dirty&&(c=()=>{const t=l.getContext("2d");t.clearRect(0,0,l.width,l.height),[].forEach(((e,n)=>{let r=0,o=0;for(;o<l.width;)t.beginPath(),t.lineWidth="2",t.strokeStyle="#"+u[n%u.length],o=Math.round(5e4*r/a/2*e),t.moveTo(o+.5,Math.round(l.height/2)-20),t.lineTo(o+.5,Math.round(l.height/2)+20),t.stroke(),t.lineWidth=1,r++}));var e=new Date;t.beginPath(),t.lineWidth="1.5",t.strokeStyle="grey",t.moveTo(0,Math.round(l.height/2)),t.lineTo(l.width,Math.round(l.height/2)),t.stroke(),o.filter((([t,e])=>t)).forEach((([e,n],r)=>{var o;((t,e,n)=>{let r=0;t.beginPath();for(let o=0;o<l.width-1;++o){const c=e(o/5e4)*l.height/2.2;let s=l.height/2;t.lineWidth="1.5",t.strokeStyle=n,t.moveTo(o,s-r),t.lineTo(o+1,s-c),r=c}t.stroke()})(t,(o=n*a,t=>Math.sin(t*o*Math.PI*2)),"#"+u[r%u.length])}));var n=new Date-e;console.log("elapsed time = "+n+" ms")})},[l,s,a,i,o,r,function(t){F[t?"unshift":"push"]((()=>{l=t,n(0,l)}))}]}class ct extends G{constructor(t){super(),L(this,t,ot,rt,c,{scaleBinary:1,frequencyRoot:2,semitones:3})}}function lt(t,e,n){const r=t.slice();return r[6]=e[n].selected,r[7]=e[n].freq,r[9]=n,r}function st(t,e,n){const r=t.slice();return r[10]=e[n][0],r[11]=e[n][1],r[9]=n,r}function at(t){let e,n,r;return{c(){e=f("rect"),y(e,"opacity","1"),y(e,"fill","#039BE5"),y(e,"width","4"),y(e,"height",ft),y(e,"y",n=(t[11]-1)*ft),y(e,"x",r=(t[10]/t[11]-1)*(t[4]-5)),y(e,"tabindex","-1")},m(t,n){s(t,e,n)},p(t,o){4&o&&n!==(n=(t[11]-1)*ft)&&y(e,"y",n),20&o&&r!==(r=(t[10]/t[11]-1)*(t[4]-5))&&y(e,"x",r)},d(t){t&&a(e)}}}function it(t){let e,n,r,o,c,i,u,h,m,p,g,v,x,w=Math.round(t[7])+"";return{c(){e=f("rect"),c=f("text"),i=d(w),u=d(" hz\n      "),m=f("text"),p=d(t[9]),y(e,"opacity",n=t[6]?.75:.25),y(e,"fill","#FF5722"),y(e,"width","2"),y(e,"height",r=t[0]*ft),y(e,"y","0"),y(e,"x",o=(t[7]-t[1])*(t[4]-5)/t[1]+1),y(e,"tabindex","-1"),y(c,"x","0"),y(c,"y","-9"),y(c,"font-family","monospace"),y(c,"transform",h="translate("+((t[7]-t[1])*(t[4]-5)/t[1]-1)+", 0) rotate(90)"),y(c,"font-size","10"),y(m,"x",g=(t[7]-t[1])*(t[4]-5)/t[1]-1),y(m,"y",v=(t[0]+1.2)*ft),y(m,"opacity",x=t[6]?1:.5),y(m,"transform","translate(, 0) rotate(90)"),y(m,"font-family","monospace"),y(m,"font-size","10")},m(t,n){s(t,e,n),s(t,c,n),l(c,i),l(c,u),s(t,m,n),l(m,p)},p(t,l){8&l&&n!==(n=t[6]?.75:.25)&&y(e,"opacity",n),1&l&&r!==(r=t[0]*ft)&&y(e,"height",r),26&l&&o!==(o=(t[7]-t[1])*(t[4]-5)/t[1]+1)&&y(e,"x",o),8&l&&w!==(w=Math.round(t[7])+"")&&$(i,w),26&l&&h!==(h="translate("+((t[7]-t[1])*(t[4]-5)/t[1]-1)+", 0) rotate(90)")&&y(c,"transform",h),26&l&&g!==(g=(t[7]-t[1])*(t[4]-5)/t[1]-1)&&y(m,"x",g),1&l&&v!==(v=(t[0]+1.2)*ft)&&y(m,"y",v),8&l&&x!==(x=t[6]?1:.5)&&y(m,"opacity",x)},d(t){t&&a(e),t&&a(c),t&&a(m)}}}function ut(e){let n,r,o,c=e[2],u=[];for(let t=0;t<c.length;t+=1)u[t]=at(st(e,c,t));let d=e[3],h=[];for(let t=0;t<d.length;t+=1)h[t]=it(lt(e,d,t));return{c(){n=f("svg"),r=f("g");for(let t=0;t<u.length;t+=1)u[t].c();o=m();for(let t=0;t<h.length;t+=1)h[t].c();y(r,"transform","translate(1, 0)"),y(n,"width",e[4]),y(n,"height",e[5])},m(t,e){s(t,n,e),l(n,r);for(let t=0;t<u.length;t+=1)u[t].m(r,null);l(r,o);for(let t=0;t<h.length;t+=1)h[t].m(r,null)},p(t,[e]){if(20&e){let n;for(c=t[2],n=0;n<c.length;n+=1){const l=st(t,c,n);u[n]?u[n].p(l,e):(u[n]=at(l),u[n].c(),u[n].m(r,o))}for(;n<u.length;n+=1)u[n].d(1);u.length=c.length}if(27&e){let n;for(d=t[3],n=0;n<d.length;n+=1){const o=lt(t,d,n);h[n]?h[n].p(o,e):(h[n]=it(o),h[n].c(),h[n].m(r,null))}for(;n<h.length;n+=1)h[n].d(1);h.length=d.length}16&e&&y(n,"width",t[4])},i:t,o:t,d(t){t&&a(n),i(u,t),i(h,t)}}}let ft=12;function dt(t,e,n){let{fareySequenceOrder:r}=e,{frequencyRoot:o}=e,{fareySequence:c}=e,{frequencyInfos:l}=e,{width:s=500}=e,a=(r+1.5)*ft;return t.$$set=t=>{"fareySequenceOrder"in t&&n(0,r=t.fareySequenceOrder),"frequencyRoot"in t&&n(1,o=t.frequencyRoot),"fareySequence"in t&&n(2,c=t.fareySequence),"frequencyInfos"in t&&n(3,l=t.frequencyInfos),"width"in t&&n(4,s=t.width)},[r,o,c,l,s,a]}class ht extends G{constructor(t){super(),L(this,t,dt,ut,c,{fareySequenceOrder:0,frequencyRoot:1,fareySequence:2,frequencyInfos:3,width:4})}}function mt(t,e,n){const r=t.slice();return r[21]=e[n].selected,r[22]=e[n].freq,r[23]=e[n].farey,r[24]=e[n].fareyError,r[25]=e[n].fareyErrorAbs,r[27]=n,r}function pt(t){let e,n,r,o,c,i,f,m,g,v,x,w,b,M,q,k,E,F,S,_,R,z,C,A,P,I,O=(t[22]?Math.round(100*t[22])/100:"")+"",T=t[23].join("/")+"",B=Math.round(1e4*t[24])/100+"",H=Math.round(100*t[25])/100+"";function W(){return t[16](t[22])}return{c(){e=u("tr"),n=u("td"),r=d(t[27]),o=h(),c=u("td"),i=d(O),f=h(),m=u("small"),m.textContent="Hz",g=h(),v=u("button"),v.textContent="▶",x=h(),w=u("td"),b=d(T),M=h(),q=u("td"),k=d(B),E=u("small"),E.textContent="%",F=h(),S=u("small"),_=d("("),R=d(H),z=d(" Hz)"),C=h(),y(n,"class","svelte-59c50t"),y(v,"class","btn-play svelte-59c50t"),y(c,"class","svelte-59c50t"),y(w,"class","svelte-59c50t"),y(q,"class","svelte-59c50t"),y(e,"style",A=t[21]?"":"opacity: .6")},m(t,a){s(t,e,a),l(e,n),l(n,r),l(e,o),l(e,c),l(c,i),l(c,f),l(c,m),l(c,g),l(c,v),l(e,x),l(e,w),l(w,b),l(e,M),l(e,q),l(q,k),l(q,E),l(q,F),l(q,S),l(S,_),l(S,R),l(S,z),l(e,C),P||(I=p(v,"click",W),P=!0)},p(n,r){t=n,16&r&&O!==(O=(t[22]?Math.round(100*t[22])/100:"")+"")&&$(i,O),16&r&&T!==(T=t[23].join("/")+"")&&$(b,T),16&r&&B!==(B=Math.round(1e4*t[24])/100+"")&&$(k,B),16&r&&H!==(H=Math.round(100*t[25])/100+"")&&$(R,H),16&r&&A!==(A=t[21]?"":"opacity: .6")&&y(e,"style",A)},d(t){t&&a(e),P=!1,I()}}}function yt(t){let e,n,o,c,f,m,x,w,b,q,k,E,F,S,_,R,z,A,P,I,O,T,D,L,G,J,K,Q,U,V,X,Y,Z,tt,et,rt,ot,lt,st,at,it,ut,ft,dt,yt,gt,$t,vt,xt,wt,bt,Mt,qt,kt,Et,Ft,St,_t,Rt,zt,Ct,At,Pt,It,Ot,Tt,Bt,Ht,Wt,jt,Nt,Dt,Lt,Gt,Jt,Kt,Qt,Ut,Vt,Xt,Yt,Zt,te,ee,ne,re,oe,ce,le,se,ae=Math.round(1e4*t[8].avgError)/100+"",ie=Math.round(1e4*t[8].maxError)/100+"",ue=3*t[1]/2+"",fe=4*t[1]/3+"",de=5*t[1]/4+"";o=new ct({props:{frequencyRoot:t[1],semitones:t[2],scaleBinary:t[3]}});let he=t[4],me=[];for(let e=0;e<he.length;e+=1)me[e]=pt(mt(t,he,e));return Pt=new nt({props:{width:t[6]>1e3?t[6]/2:280,height:t[6]>1e3?t[6]/3:280,frequencyInfos:t[4],semitones:t[2],generator:t[7],frequencyRoot:t[1]}}),Nt=new ht({props:{fareySequenceOrder:t[0],frequencyRoot:t[1],fareySequence:t[5],frequencyInfos:t[4],width:t[6]>1e3?t[6]/2:t[6]}}),{c(){e=u("h1"),e.textContent="Equal temperament playground",n=h(),W(o.$$.fragment),c=h(),f=u("div"),m=u("span"),x=d("Scale: "),w=u("input"),b=h(),q=u("span"),k=d("Fundamental frequency ("),E=u("em"),E.textContent="hz",F=d("): "),S=u("input"),_=h(),R=u("span"),z=d("Semi-tones: "),A=u("input"),P=h(),I=u("span"),O=d("Farey sequence order: "),T=u("input"),D=h(),L=u("div"),G=u("div"),J=u("div"),K=u("table"),Q=u("thead"),U=u("tr"),V=u("th"),X=h(),Y=u("th"),Z=h(),tt=u("th"),et=d("Farey order "),rt=d(t[0]),ot=h(),lt=u("tr"),lt.innerHTML='<th scope="col" class="svelte-59c50t">Semi-<br/>tone</th> \n            <th scope="col" class="svelte-59c50t">Frequency<br/>(Hz)</th> \n            <th scope="col" class="svelte-59c50t">Ratio</th> \n            <th scope="col" class="svelte-59c50t">Error<br/>(Hz)</th>',st=h(),at=u("tbody");for(let t=0;t<me.length;t+=1)me[t].c();it=h(),ut=u("tfoot"),ft=u("tr"),dt=u("th"),yt=h(),gt=u("th"),$t=h(),vt=u("th"),xt=h(),wt=u("th"),bt=d("Avg(error) = "),Mt=d(ae),qt=u("small"),qt.textContent="%",kt=u("br"),Et=d("\n              Max(error) = "),Ft=d(ie),St=u("small"),St.textContent="%",_t=h(),Rt=u("div"),zt=u("div"),Ct=u("h4"),Ct.textContent="Circle of firth",At=h(),W(Pt.$$.fragment),It=u("br"),Ot=d("\n        Generator: "),Tt=u("input"),Bt=h(),Ht=u("div"),Wt=u("h4"),Wt.innerHTML='<a href="https://en.wikipedia.org/wiki/Farey_sequence">Farey sequence pattern</a>',jt=h(),W(Nt.$$.fragment),Dt=h(),Lt=u("div"),Gt=u("p"),Jt=d("Perfect fifth: "),Kt=d(ue),Qt=d(" Hz"),Ut=u("br"),Vt=d("\n          Perfect fourth: "),Xt=d(fe),Yt=d(" Hz"),Zt=u("br"),te=d("\n          Major third: "),ee=d(de),ne=d(" Hz"),re=u("br"),y(e,"class","svelte-59c50t"),y(w,"type","text"),y(w,"maxlength",t[2]),y(m,"class","svelte-59c50t"),y(S,"type","number"),y(S,"class","svelte-59c50t"),y(q,"class","svelte-59c50t"),y(A,"type","number"),y(A,"class","svelte-59c50t"),y(R,"class","svelte-59c50t"),y(T,"type","number"),y(T,"min","2"),y(T,"max","200"),y(T,"class","svelte-59c50t"),y(I,"class","svelte-59c50t"),y(f,"class","row main-inputs svelte-59c50t"),y(V,"scope","col"),y(V,"class","svelte-59c50t"),y(Y,"scope","col"),y(Y,"class","svelte-59c50t"),y(tt,"scope","col"),y(tt,"colspan","3"),y(tt,"class","svelte-59c50t"),y(Q,"class","svelte-59c50t"),y(dt,"scope","col"),y(dt,"class","svelte-59c50t"),y(gt,"scope","col"),y(gt,"class","svelte-59c50t"),y(vt,"scope","col"),y(vt,"class","svelte-59c50t"),y(wt,"scope","col"),y(wt,"class","svelte-59c50t"),y(ut,"class","svelte-59c50t"),y(K,"class","svelte-59c50t"),y(J,"class","column svelte-59c50t"),y(Tt,"class","input-small svelte-59c50t"),y(Tt,"type","number"),y(Tt,"max","199"),y(zt,"id","tone-circle"),y(Ht,"id","farey-sequence-pattern"),y(Rt,"class","column svelte-59c50t"),y(G,"class","row svelte-59c50t"),C((()=>t[18].call(G))),y(L,"class","main")},m(r,i){s(r,e,i),s(r,n,i),j(o,r,i),s(r,c,i),s(r,f,i),l(f,m),l(m,x),l(m,w),v(w,t[3]),l(f,b),l(f,q),l(q,k),l(q,E),l(q,F),l(q,S),v(S,t[1]),l(f,_),l(f,R),l(R,z),l(R,A),v(A,t[2]),l(f,P),l(f,I),l(I,O),l(I,T),v(T,t[0]),s(r,D,i),s(r,L,i),l(L,G),l(G,J),l(J,K),l(K,Q),l(Q,U),l(U,V),l(U,X),l(U,Y),l(U,Z),l(U,tt),l(tt,et),l(tt,rt),l(Q,ot),l(Q,lt),l(K,st),l(K,at);for(let t=0;t<me.length;t+=1)me[t].m(at,null);l(K,it),l(K,ut),l(ut,ft),l(ft,dt),l(ft,yt),l(ft,gt),l(ft,$t),l(ft,vt),l(ft,xt),l(ft,wt),l(wt,bt),l(wt,Mt),l(wt,qt),l(wt,kt),l(wt,Et),l(wt,Ft),l(wt,St),l(G,_t),l(G,Rt),l(Rt,zt),l(zt,Ct),l(zt,At),j(Pt,zt,null),l(zt,It),l(zt,Ot),l(zt,Tt),v(Tt,t[7]),l(Rt,Bt),l(Rt,Ht),l(Ht,Wt),l(Ht,jt),j(Nt,Ht,null),l(Rt,Dt),l(Rt,Lt),l(Lt,Gt),l(Gt,Jt),l(Gt,Kt),l(Gt,Qt),l(Gt,Ut),l(Gt,Vt),l(Gt,Xt),l(Gt,Yt),l(Gt,Zt),l(Gt,te),l(Gt,ee),l(Gt,ne),l(Gt,re),oe=function(t,e){"static"===getComputedStyle(t).position&&(t.style.position="relative");const n=u("iframe");n.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),n.setAttribute("aria-hidden","true"),n.tabIndex=-1;const r=M();let o;return r?(n.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",o=p(window,"message",(t=>{t.source===n.contentWindow&&e()}))):(n.src="about:blank",n.onload=()=>{o=p(n.contentWindow,"resize",e)}),l(t,n),()=>{(r||o&&n.contentWindow)&&o(),a(n)}}(G,t[18].bind(G)),ce=!0,le||(se=[p(w,"input",t[12]),p(S,"input",t[13]),p(A,"input",t[14]),p(T,"input",t[15]),p(Tt,"input",t[17])],le=!0)},p(t,[e]){const n={};if(2&e&&(n.frequencyRoot=t[1]),4&e&&(n.semitones=t[2]),8&e&&(n.scaleBinary=t[3]),o.$set(n),(!ce||4&e)&&y(w,"maxlength",t[2]),8&e&&w.value!==t[3]&&v(w,t[3]),2&e&&g(S.value)!==t[1]&&v(S,t[1]),4&e&&g(A.value)!==t[2]&&v(A,t[2]),1&e&&g(T.value)!==t[0]&&v(T,t[0]),(!ce||1&e)&&$(rt,t[0]),16&e){let n;for(he=t[4],n=0;n<he.length;n+=1){const r=mt(t,he,n);me[n]?me[n].p(r,e):(me[n]=pt(r),me[n].c(),me[n].m(at,null))}for(;n<me.length;n+=1)me[n].d(1);me.length=he.length}(!ce||256&e)&&ae!==(ae=Math.round(1e4*t[8].avgError)/100+"")&&$(Mt,ae),(!ce||256&e)&&ie!==(ie=Math.round(1e4*t[8].maxError)/100+"")&&$(Ft,ie);const r={};64&e&&(r.width=t[6]>1e3?t[6]/2:280),64&e&&(r.height=t[6]>1e3?t[6]/3:280),16&e&&(r.frequencyInfos=t[4]),4&e&&(r.semitones=t[2]),128&e&&(r.generator=t[7]),2&e&&(r.frequencyRoot=t[1]),Pt.$set(r),128&e&&g(Tt.value)!==t[7]&&v(Tt,t[7]);const c={};1&e&&(c.fareySequenceOrder=t[0]),2&e&&(c.frequencyRoot=t[1]),32&e&&(c.fareySequence=t[5]),16&e&&(c.frequencyInfos=t[4]),64&e&&(c.width=t[6]>1e3?t[6]/2:t[6]),Nt.$set(c),(!ce||2&e)&&ue!==(ue=3*t[1]/2+"")&&$(Kt,ue),(!ce||2&e)&&fe!==(fe=4*t[1]/3+"")&&$(Xt,fe),(!ce||2&e)&&de!==(de=5*t[1]/4+"")&&$(ee,de)},i(t){ce||(B(o.$$.fragment,t),B(Pt.$$.fragment,t),B(Nt.$$.fragment,t),ce=!0)},o(t){H(o.$$.fragment,t),H(Pt.$$.fragment,t),H(Nt.$$.fragment,t),ce=!1},d(t){t&&a(e),t&&a(n),N(o,t),t&&a(c),t&&a(f),t&&a(D),t&&a(L),i(me,t),N(Pt),N(Nt),oe(),le=!1,r(se)}}}function gt(t,e,n){let r,o,c,l,s,a,i;const u=(t,e)=>{let n=null,r=null;return t.forEach((([t,o])=>{let c=Math.abs(t/o-e);(null===n||c<n)&&(n=c,r=[t,o])})),r};let f,d=15,h=440,m=12,p="101101011010";return t.$$.update=()=>{1&t.$$.dirty&&n(5,r=(t=>{let e={};for(let n=1;n<=t;++n)for(let t=0;t<=n;++t){let r=Math.round(t/n*1e4)/1e4;e[r]=e[r]??[t+n,n]}return Object.values(e).sort((([t,e],[n,r])=>t/e-n/r))})(d)),4&t.$$.dirty&&n(11,o=t=>2**(t/m)),2060&t.$$.dirty&&n(10,c=p.padEnd(m+1,"0").split("").map(((t,e)=>["1"===t||"x"===t,o(e)]))),34&t.$$.dirty&&n(9,l=([t,e])=>{const n={selected:t,normalizedFreq:e-1,freq:e*h,farey:u(r,e)};return n.fareyError=1-1/e*n.farey[0]/n.farey[1],n.fareyErrorAbs=e*h-h*n.farey[0]/n.farey[1],n}),1536&t.$$.dirty&&n(4,s=c.map(l)),20&t.$$.dirty&&n(8,a=(()=>{console.log(1);let t=null,e=0;return s.forEach((({freq:n,fareyError:r})=>{t=Math.max(t,r),e+=Math.abs(r)})),{maxError:t,avgError:e/m}})())},n(7,i=7),[d,h,m,p,s,r,f,i,a,l,c,o,function(){p=this.value,n(3,p)},function(){h=g(this.value),n(1,h)},function(){m=g(this.value),n(2,m)},function(){d=g(this.value),n(0,d)},t=>K(t,1),function(){i=g(this.value),n(7,i)},function(){f=this.clientWidth,n(6,f)}]}return new class extends G{constructor(t){super(),L(this,t,gt,yt,c,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
